<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Villa Park Little League</title>

  <!-- Link to CSS and JS -->
  <link rel="stylesheet" href="style.css" />
  <script src="app.js?v=2" defer></script>


  <!-- PWA / icon -->
  <link rel="manifest" href="manifest.json" />
  <link rel="icon" type="image/png" href="60thlogo.jpg" />
</head>
<body>
  <!-- Header -->
  <header>
    <img src="60thlogo.jpg" alt="Villa Park Vibe Logo" />
    Villa Park Little League
  </header>
<!-- Pull-to-Refresh Spinner -->
<div id="ptr" class="ptr-spinner">
    <img src="baseball-spinner.svg" class="baseball-spinner" alt="Loading" />
    <div class="spinner-text">Refreshingâ€¦</div>
</div>

  <!-- Main Content -->
  <main id="page-root"></main>
<!-- Notification Preferences -->
<section id="notificationsSection" style="display:none; padding:20px;">
  <h3>Push Notification Preferences</h3>
  <p>Select updates you want to receive:</p>

  <label>
    <input type="checkbox" class="notif-topic" value="A1 Fireston">
    A1 Fireston
  </label>

  <button id="saveNotifPrefsBtn">Save Preferences</button>
</section>

<!-- Bottom Navigation -->
<nav id="bottomNav">
  <button class="nav-btn" data-page="home">
    <span class="icon">ğŸ </span>
    <span class="label">Home</span>
  </button>

  <button class="nav-btn" data-page="schedule">
    <span class="icon">ğŸ“…</span>
    <span class="label">Schedule</span>
  </button>

  <button class="nav-btn" data-page="standings">
    <span class="icon">ğŸ†</span>
    <span class="label">Standings</span>
  </button>

  <button class="nav-btn" data-page="more">
    <span class="icon">â‹¯</span>
    <span class="label">More</span>
  </button>
</nav>



  <!-- IMPORTANT: Admin tab (starts hidden) -->
  <button 
    class="nav-btn" 
    data-page="admin" 
    id="adminTab" 
    style="display:none;"
  >
    ğŸ” Admin
  </button>
</nav>


  <!-- Optional: Service Worker -->
<script>
if ("serviceWorker" in navigator) {
    navigator.serviceWorker
        .register("service-worker.js")
        .then(() => {
            console.log("Service Worker registered");

            // ===== Push Notification Subscription (Step 2) =====
            if ("PushManager" in window) {
                navigator.serviceWorker.ready.then(reg => {
                    reg.pushManager.getSubscription().then(async sub => {
                        if (sub) {
                            console.log("Already subscribed:", sub);
                            return;
                        }

                        // Subscribe user with your VAPID KEY (already in app.js)
                        const newSub = await reg.pushManager.subscribe({
                            userVisibleOnly: true,
                            applicationServerKey: urlBase64ToUint8Array(VAPID_PUBLIC_KEY)
                        });

                        console.log("New push subscription:", newSub);

                        // TODO: Send new subscription to your server if needed
                    });
                });
            }
        })
        .catch((err) => console.error("Service Worker failed", err));
}
</script>

</body>
</html>
